This notebook inputs per-plate profiles as generated by the [pooled-cell-painting-profiling-recipe](https://github.com/broadinstitute/pooled-cell-painting-profiling-recipe) and further aggregates them into the per-experiment guide-level profiles that have undergone feature selection used in this paper for generating hit lists (see [Hit_Calling](../Hit_Calling/)).
The guide-level profiles are further aggregatd into gene-level profiles used for generating figures in this paper.

To run the notebooks you will need to download the following files to the `inputs_data` folder.
These are the profiles generated by the recipe.
`20200805_A549_WG_Screen_guide_normalized_feature_select_median_merged_ALLBATCHES___CP186___ALLWELLS.csv.gz`  
`20210422_6W_CP257_guide_normalized_feature_select_median_merged_ALLBATCHES___DMEM___ALLWELLS.csv.gz`  
`20210422_6W_CP257_guide_normalized_feature_select_median_merged_ALLBATCHES___HPLM___ALLWELLS.csv.gz` 

The following command will download these files:
```bash
aws s3 sync --no-sign-request s3://cellpainting-gallery/cpg-0021-periscope/broad/workspace/profiles/ inputs_data --exclude "*" --include "20210422_6W_CP257_guide_normalized_feature_select_median_merged_ALLBATCHES___*" --include "20200805_A549_WG_Screen_guide_normalized_feature_select_median_merged_ALLBATCHES___*"
```

Profile aggregation is a computationally intensive procedure.
You can directly download the per-experiment guide-level profiles generated in this notebook with the following command:
```bash
aws s3 sync --no-sign-request s3://cellpainting-gallery/cpg-0021-periscope/broad/workspace/profiles/ outputs_data --exclude "*" --include 
```

You can directly download the gene-level aggregated profiles generated in this notebook with the following command:
```
aws s3 sync --no-sign-request s3://cellpainting-gallery/cpg-0021-periscope/broad/workspace/profiles/ outputs_data --exclude "*" --include
```